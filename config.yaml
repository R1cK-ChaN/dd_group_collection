# DingTalk Group File Collector — Configuration
# Edit this file to match your environment. No Python edits should be needed.

# ── DingTalk settings ──
dingtalk:
  # Window class name used to find the DingTalk main window
  window_class: "StandardFrame_DingTalk"
  # Where DingTalk saves downloaded files (check DingTalk settings)
  download_dir: "C:\\Users\\vm\\Documents\\DingDing\\download"
  # Seconds to wait for UI controls to appear
  timeout: 10
  # Seconds to wait after clicking download before checking for the file
  download_wait: 5
  # Pixels from the right edge of a file row to the download icon center.
  # Adjust if DingTalk changes its hover-icon layout.
  download_icon_offset: 95

# ── Groups to collect files from ──
# name  : exact display name in DingTalk (used for search)
# alias : folder name on Google Drive (optional, defaults to name)
groups:
  - name: "Degg"
    alias: "Degg"
  - name: "资料分享群"
    alias: "资料分享群"

# ── Google Drive settings ──
gdrive:
  # Root folder where files will be organized as {alias}/{YYYY-MM}/{filename}
  base_path: "G:\\My Drive\\DingTalk Files"

# ── Polling ──
polling:
  interval_minutes: 30
  # Max files to download per group per cycle (safety cap)
  max_downloads_per_group: 50

# ── Dedup tracker ──
dedup:
  path: "data/downloaded.json"

# ── Logging ──
logging:
  dir: "logs"
  level: "INFO"
  max_bytes: 10485760      # 10 MB
  backup_count: 5

# ── UI Selectors ──
# These map to uiautomation control properties.
# Update when DingTalk changes its UI. Use tools/inspect_dingtalk.py to find values.
ui_selectors:
  search_box:
    control_type: "EditControl"
    name: "Search"
  search_result_item:
    control_type: "ListItemControl"
  files_tab:
    control_type: "ButtonControl"
    name: "File"
    # Fallback if ButtonControl doesn't match
    fallback_control_type: "TabItemControl"
  file_list:
    control_type: "ListControl"
    name: ""
  file_item:
    control_type: "ListItemControl"
  download_button:
    control_type: "ButtonControl"
    name: "Download"
  context_menu_download:
    control_type: "MenuItemControl"
    name: "Download"
  # Dismiss-dialog button texts (checked in order)
  dismiss_buttons:
    - "Later"
    - "Cancel"
    - "OK"
    - "Ignore this version"
    - "稍后"
    - "取消"
    - "我知道了"
    - "忽略此版本"
