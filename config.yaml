# DingTalk Group File Collector — Configuration
# Edit this file to match your environment. No Python edits should be needed.

# ── DingTalk settings ──
dingtalk:
  # Window class name used to find the DingTalk main window.
  # Known classes: "DtMainFrameView" (current), "StandardFrame_DingTalk" (legacy)
  window_class: "DtMainFrameView"
  # Where DingTalk saves downloaded files (check DingTalk settings)
  download_dir: "C:\\Users\\vm\\Documents\\DingDing\\download"
  # Seconds to wait for UI controls to appear
  timeout: 10
  # Seconds to wait after clicking download before checking for the file
  download_wait: 5
  # Pixels LEFT of the row's right edge where the download icon center is.
  # The hover icons appear near the right edge of the BoundingRectangle.
  # Adjust if DingTalk changes its hover-icon layout.
  download_icon_offset: 8

# ── Groups to collect files from ──
# name  : exact display name in DingTalk (used for search)
# alias : folder name on Google Drive (optional, defaults to name)
groups:
  - name: "Degg"
    alias: "Degg"
  - name: "资料分享群"
    alias: "资料分享群"

# ── Google Drive settings ──
gdrive:
  # Root folder where files will be organized as {alias}/{YYYY-MM}/{filename}
  base_path: "G:\\My Drive\\DingTalk Files"

# ── Polling ──
polling:
  interval_minutes: 30
  # Max files to download per group per cycle (safety cap)
  max_downloads_per_group: 50

# ── Dedup tracker ──
dedup:
  path: "data/downloaded.json"

# ── Logging ──
logging:
  dir: "logs"
  level: "INFO"
  max_bytes: 10485760      # 10 MB
  backup_count: 5

# ── VLM (Vision Language Model for UI element detection) ──
vlm:
  # OpenRouter API key (can also be set via OPENROUTER_API_KEY env var)
  api_key: "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"
  model: "qwen/qwen-vl-plus"
  base_url: "https://openrouter.ai/api/v1"
  # Pixels around the right-click point to capture for context menu screenshot
  capture_margin: 300

# ── UI Selectors ──
# These map to uiautomation control properties.
# Update when DingTalk changes its UI. Use tools/inspect_dingtalk.py to find values.
ui_selectors:
  search_box:
    control_type: "EditControl"
    # Name is empty — match by ClassName instead.
    # The search box is a QLineEdit in the top bar.
    name: ""
    class_name: "QLineEdit"
  search_result_item:
    control_type: "ListItemControl"
  files_tab:
    control_type: "ButtonControl"
    name: "Files"
    # Fallback if ButtonControl doesn't match
    fallback_control_type: "TabItemControl"
  file_list:
    control_type: "ListControl"
    name: ""
  file_item:
    control_type: "ListItemControl"
  download_button:
    control_type: "ButtonControl"
    name: "Download"
  context_menu_download:
    control_type: "MenuItemControl"
    name: "Download"
  # Dismiss-dialog button texts (checked in order)
  dismiss_buttons:
    - "Later"
    - "Cancel"
    - "OK"
    - "Ignore this version"
    - "稍后"
    - "取消"
    - "我知道了"
    - "忽略此版本"
